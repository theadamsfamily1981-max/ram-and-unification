# Ara-SYNERGY: Real-Time Kernel Configuration for GRUB
#
# Purpose: Carve out an isolated CPU island for Ara's HAA pipeline
# Target: Multi-core Threadripper or Xeon systems
#
# Installation:
#   sudo cp grub-realtime.conf /etc/default/grub.d/99-ara-rt.cfg
#   sudo update-grub
#   sudo reboot
#
# WARNING: Adjust CPU core numbers to match your system topology!

# Isolate cores 8-15 for Ara's exclusive use
# These cores will NOT run general system tasks, GNOME, browsers, etc.
#
# isolcpus: Remove cores from general scheduler
# nohz_full: Disable kernel tick on these cores (adaptive-tick mode)
# rcu_nocbs: Offload RCU callbacks from these cores
# intel_pstate=disable: Use ACPI P-states for predictable frequency (AMD: N/A)

GRUB_CMDLINE_LINUX_DEFAULT="quiet splash \
  isolcpus=8-15 \
  nohz_full=8-15 \
  rcu_nocbs=8-15 \
  intel_pstate=disable"

# Optional: For AMD systems, you might want:
# GRUB_CMDLINE_LINUX_DEFAULT="quiet splash \
#   isolcpus=8-15 \
#   nohz_full=8-15 \
#   rcu_nocbs=8-15"

# Verification after reboot:
#   cat /proc/cmdline
#   cat /sys/devices/system/cpu/isolated
#   taskset -c -p $$  # Should show you're NOT on 8-15
